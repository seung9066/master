<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.sgg.learn.mapper.LearnMapper">

    <!-- 목록 조회 -->
    <select id="getList" parameterType="map" resultType="resultMap">
        /* com.sgg.learn.mapper.LearnMapper.getList */
        SELECT A1.CODE_NO
            , (SELECT CD_DTL_NAME
                FROM SGG_CD_DTL
                WHERE 1 = 1
                AND CD_DTL = A1.CODE_TYPE
                AND CD_ID = 'CODE_TYPE'
                AND DEL_YN = 'N') AS CODE_TYPE
            , A1.CODE_TITLE
        FROM SGG_CMN_CODE A1
            , SGG_CMN_CODE_DTL A2
        WHERE 1 = 1
        AND A1.CODE_NO = A2.CODE_NO
        AND A1.DEL_YN = 'N'
        <if test="type != null and type != ''">
            AND A1.CODE_TYPE = #{type}
        </if>
        <if test="title != null and title != ''">
            AND A1.CODE_TITLE LIKE '%' || #{title} || '%'
        </if>
    </select>

    <!-- 목록 수 -->
    <select id="getListCnt" parameterType="map" resultType="int">
        /* com.sgg.learn.mapper.LearnMapper.getListCnt */
        SELECT COUNT(*)
        FROM (SELECT A1.CODE_NO
                , (SELECT CD_DTL_NAME
                    FROM SGG_CD_DTL
                    WHERE 1 = 1
                    AND CD_DTL = A1.CODE_TYPE
                    AND CD_ID = 'CODE_TYPE'
                    AND DEL_YN = 'N') AS CODE_TYPE
                , A1.CODE_TITLE
                FROM SGG_CMN_CODE A1
                    , SGG_CMN_CODE_DTL A2
                WHERE 1 = 1
                AND A1.CODE_NO = A2.CODE_NO
                AND A1.DEL_YN = 'N'
                <if test="type != null and type != ''">
                    AND A1.CODE_TYPE = #{type}
                </if>
                <if test="title != null and title != ''">
                    AND A1.CODE_TITLE LIKE '%' || #{title} || '%'
                </if>)
    </select>

    <!-- 상세조회 -->
    <select id="getDtl" parameterType="map" resultType="resultMap">
        /* com.sgg.learn.mapper.LearnMapper.getDtl */
        SELECT A1.DIV_NO
            , A1.DIV_CODE
            , A2.CODE_TITLE
        FROM SGG_CMN_CODE_DTL A1
            , SGG_CMN_CODE A2
        WHERE 1 = 1
        AND A1.CODE_NO = A2.CODE_NO
        AND A1.CODE_NO = #{codeNo}
    </select>
</mapper>